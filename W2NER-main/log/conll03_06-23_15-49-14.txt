2024-06-23 15:49:14 - INFO: dict_items([('dataset', 'conll03'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 768), ('conv_hid_size', 96), ('bert_hid_size', 1024), ('biaffine_size', 768), ('ffnn_hid_size', 128), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 12), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 1.0), ('bert_name', 'bert-large-cased'), ('bert_learning_rate', 1e-05), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/conll03.json'), ('device', 0)])
2024-06-23 15:49:14 - INFO: Loading Data
2024-06-23 15:49:19 - INFO: 
+---------+-----------+----------+
| conll03 | sentences | entities |
+---------+-----------+----------+
|  train  |   17291   |  29441   |
|   dev   |    3453   |   5648   |
|   test  |    3453   |   5648   |
+---------+-----------+----------+
2024-06-23 15:50:40 - INFO: Building Model
2024-06-23 15:50:53 - INFO: Epoch: 0
2024-06-23 16:01:21 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0659 | 0.5617 |   0.5844  | 0.6084 |
+---------+--------+--------+-----------+--------+
2024-06-23 16:02:12 - INFO: EVAL Label F1 [0.99955006 0.95539108 0.87511796 0.63018641 0.95695262 0.8598954 ]
2024-06-23 16:02:12 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8795 |   0.8595  | 0.9074 |
| Entity | 0.8661 |   0.8464  | 0.8867 |
+--------+--------+-----------+--------+
2024-06-23 16:03:03 - INFO: TEST Label F1 [0.99955006 0.95539108 0.87511796 0.63018641 0.95695262 0.8598954 ]
2024-06-23 16:03:03 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8795 |   0.8595  | 0.9074 |
| Entity | 0.8661 |   0.8464  | 0.8867 |
+--------+--------+-----------+--------+
2024-06-23 16:03:07 - INFO: Epoch: 1
2024-06-23 16:12:09 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0028 | 0.9379 |   0.9440  | 0.9322 |
+---------+--------+--------+-----------+--------+
2024-06-23 16:13:01 - INFO: EVAL Label F1 [0.99965828 0.9558678  0.90291554 0.78481013 0.96692427 0.92908224]
2024-06-23 16:13:01 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9232 |   0.9103  | 0.9375 |
| Entity | 0.9165 |   0.9114  | 0.9217 |
+--------+--------+-----------+--------+
2024-06-23 16:13:51 - INFO: TEST Label F1 [0.99965828 0.9558678  0.90291554 0.78481013 0.96692427 0.92908224]
2024-06-23 16:13:51 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9232 |   0.9103  | 0.9375 |
| Entity | 0.9165 |   0.9114  | 0.9217 |
+--------+--------+-----------+--------+
2024-06-23 16:13:54 - INFO: Epoch: 2
2024-06-23 16:23:04 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0018 | 0.9587 |   0.9603  | 0.9572 |
+---------+--------+--------+-----------+--------+
2024-06-23 16:23:55 - INFO: EVAL Label F1 [0.99972285 0.96586548 0.90542169 0.83628632 0.96738117 0.92959427]
2024-06-23 16:23:55 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9340 |   0.9327  | 0.9354 |
| Entity | 0.9214 |   0.9238  | 0.9189 |
+--------+--------+-----------+--------+
2024-06-23 16:24:46 - INFO: TEST Label F1 [0.99972285 0.96586548 0.90542169 0.83628632 0.96738117 0.92959427]
2024-06-23 16:24:46 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9340 |   0.9327  | 0.9354 |
| Entity | 0.9214 |   0.9238  | 0.9189 |
+--------+--------+-----------+--------+
2024-06-23 16:24:49 - INFO: Epoch: 3
2024-06-23 16:33:43 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0012 | 0.9717 |   0.9729  | 0.9704 |
+---------+--------+--------+-----------+--------+
2024-06-23 16:34:34 - INFO: EVAL Label F1 [0.9997103  0.9623431  0.91053095 0.82122093 0.96766169 0.93454545]
2024-06-23 16:34:34 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9327 |   0.9315  | 0.9343 |
| Entity | 0.9242 |   0.9262  | 0.9223 |
+--------+--------+-----------+--------+
2024-06-23 16:35:25 - INFO: TEST Label F1 [0.9997103  0.9623431  0.91053095 0.82122093 0.96766169 0.93454545]
2024-06-23 16:35:25 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9327 |   0.9315  | 0.9343 |
| Entity | 0.9242 |   0.9262  | 0.9223 |
+--------+--------+-----------+--------+
2024-06-23 16:35:28 - INFO: Epoch: 4
2024-06-23 16:44:25 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0010 | 0.9790 |   0.9793  | 0.9787 |
+---------+--------+--------+-----------+--------+
2024-06-23 16:45:16 - INFO: EVAL Label F1 [0.99969961 0.95714004 0.90765634 0.81280445 0.97003745 0.93854072]
2024-06-23 16:45:16 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9310 |   0.9226  | 0.9400 |
| Entity | 0.9225 |   0.9183  | 0.9269 |
+--------+--------+-----------+--------+
2024-06-23 16:46:07 - INFO: TEST Label F1 [0.99969961 0.95714004 0.90765634 0.81280445 0.97003745 0.93854072]
2024-06-23 16:46:07 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9310 |   0.9226  | 0.9400 |
| Entity | 0.9225 |   0.9183  | 0.9269 |
+--------+--------+-----------+--------+
2024-06-23 16:46:07 - INFO: Epoch: 5
2024-06-23 16:55:02 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0007 | 0.9851 |   0.9851  | 0.9851 |
+---------+--------+--------+-----------+--------+
2024-06-23 16:55:53 - INFO: EVAL Label F1 [0.99971773 0.96189906 0.91240658 0.82984658 0.96928328 0.93357164]
2024-06-23 16:55:53 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9345 |   0.9275  | 0.9416 |
| Entity | 0.9254 |   0.9223  | 0.9285 |
+--------+--------+-----------+--------+
2024-06-23 16:56:43 - INFO: TEST Label F1 [0.99971773 0.96189906 0.91240658 0.82984658 0.96928328 0.93357164]
2024-06-23 16:56:43 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9345 |   0.9275  | 0.9416 |
| Entity | 0.9254 |   0.9223  | 0.9285 |
+--------+--------+-----------+--------+
2024-06-23 16:56:46 - INFO: Epoch: 6
2024-06-23 17:05:41 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0005 | 0.9883 |   0.9880  | 0.9887 |
+---------+--------+--------+-----------+--------+
2024-06-23 17:06:32 - INFO: EVAL Label F1 [0.99969682 0.95693402 0.90785988 0.83074753 0.96842105 0.9370126 ]
2024-06-23 17:06:32 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9334 |   0.9250  | 0.9423 |
| Entity | 0.9244 |   0.9184  | 0.9304 |
+--------+--------+-----------+--------+
2024-06-23 17:07:23 - INFO: TEST Label F1 [0.99969682 0.95693402 0.90785988 0.83074753 0.96842105 0.9370126 ]
2024-06-23 17:07:23 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9334 |   0.9250  | 0.9423 |
| Entity | 0.9244 |   0.9184  | 0.9304 |
+--------+--------+-----------+--------+
2024-06-23 17:07:23 - INFO: Epoch: 7
2024-06-23 17:16:19 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0003 | 0.9923 |   0.9922  | 0.9923 |
+---------+--------+--------+-----------+--------+
2024-06-23 17:17:11 - INFO: EVAL Label F1 [0.99973445 0.964993   0.91559797 0.83120567 0.96900186 0.93915663]
2024-06-23 17:17:11 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9366 |   0.9335  | 0.9398 |
| Entity | 0.9276 |   0.9279  | 0.9272 |
+--------+--------+-----------+--------+
2024-06-23 17:18:01 - INFO: TEST Label F1 [0.99973445 0.964993   0.91559797 0.83120567 0.96900186 0.93915663]
2024-06-23 17:18:01 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9366 |   0.9335  | 0.9398 |
| Entity | 0.9276 |   0.9279  | 0.9272 |
+--------+--------+-----------+--------+
2024-06-23 17:18:04 - INFO: Epoch: 8
2024-06-23 17:27:01 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0002 | 0.9942 |   0.9942  | 0.9943 |
+---------+--------+--------+-----------+--------+
2024-06-23 17:27:52 - INFO: EVAL Label F1 [0.99972608 0.96312537 0.91731576 0.82311978 0.97033375 0.93983837]
2024-06-23 17:27:52 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9356 |   0.9287  | 0.9427 |
| Entity | 0.9279 |   0.9249  | 0.9309 |
+--------+--------+-----------+--------+
2024-06-23 17:28:42 - INFO: TEST Label F1 [0.99972608 0.96312537 0.91731576 0.82311978 0.97033375 0.93983837]
2024-06-23 17:28:42 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9356 |   0.9287  | 0.9427 |
| Entity | 0.9279 |   0.9249  | 0.9309 |
+--------+--------+-----------+--------+
2024-06-23 17:28:45 - INFO: Epoch: 9
2024-06-23 17:37:43 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0002 | 0.9949 |   0.9945  | 0.9952 |
+---------+--------+--------+-----------+--------+
2024-06-23 17:38:36 - INFO: EVAL Label F1 [0.99972469 0.96274158 0.91562686 0.8273432  0.96992248 0.93952096]
2024-06-23 17:38:36 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9298  | 0.9420 |
| Entity | 0.9275 |   0.9244  | 0.9306 |
+--------+--------+-----------+--------+
2024-06-23 17:39:28 - INFO: TEST Label F1 [0.99972469 0.96274158 0.91562686 0.8273432  0.96992248 0.93952096]
2024-06-23 17:39:28 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9298  | 0.9420 |
| Entity | 0.9275 |   0.9244  | 0.9306 |
+--------+--------+-----------+--------+
2024-06-23 17:39:28 - INFO: Best DEV F1: 0.9279
2024-06-23 17:39:28 - INFO: Best TEST F1: 0.9279
2024-06-23 17:40:20 - INFO: TEST Label F1 [0.99972608 0.96312537 0.91731576 0.82311978 0.97033375 0.93983837]
2024-06-23 17:40:20 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.9356 |   0.9287  | 0.9427 |
|   Entity   | 0.9279 |   0.9249  | 0.9309 |
+------------+--------+-----------+--------+
