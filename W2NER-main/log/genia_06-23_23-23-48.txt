2024-06-23 23:23:48 - INFO: dict_items([('dataset', 'genia'), ('save_path', './model_genia.pt'), ('predict_path', './output_genia.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 128), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 384), ('dilation', [1, 2, 3, 4]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 8), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'dmis-lab/biobert-v1.1'), ('bert_learning_rate', 5e-06), ('warm_factor', 0.1), ('use_bert_last_4_layers', False), ('seed', 123), ('config', './config/genia.json'), ('device', 0)])
2024-06-23 23:23:48 - INFO: Loading Data
2024-06-23 23:23:55 - INFO: 
+-------+-----------+----------+
| genia | sentences | entities |
+-------+-----------+----------+
| train |   15023   |  45144   |
|  dev  |    1669   |   5365   |
|  test |    1854   |   5506   |
+-------+-----------+----------+
2024-06-23 23:25:44 - INFO: Building Model
2024-06-23 23:27:59 - INFO: Epoch: 0
2024-06-23 23:34:22 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0709 | 0.3719 |   0.3931  | 0.4248 |
+---------+--------+--------+-----------+--------+
2024-06-23 23:35:00 - INFO: EVAL Label F1 [0.99876609 0.88027708 0.80084151 0.74526678 0.67533875 0.76177658
 0.72131148]
2024-06-23 23:35:00 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7977 |   0.8092  | 0.7945 |
| Entity | 0.7737 |   0.7604  | 0.7875 |
+--------+--------+-----------+--------+
2024-06-23 23:35:38 - INFO: TEST Label F1 [0.99875013 0.88358209 0.76770754 0.71938776 0.72378517 0.73441109
 0.8       ]
2024-06-23 23:35:38 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8039 |   0.8157  | 0.7975 |
| Entity | 0.7544 |   0.7563  | 0.7525 |
+--------+--------+-----------+--------+
2024-06-23 23:35:39 - INFO: Epoch: 1
2024-06-23 23:41:57 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0074 | 0.7866 |   0.8177  | 0.7605 |
+---------+--------+--------+-----------+--------+
2024-06-23 23:42:35 - INFO: EVAL Label F1 [0.99903207 0.90387016 0.85534038 0.7860262  0.74473068 0.81315789
 0.80769231]
2024-06-23 23:42:35 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8443 |   0.8300  | 0.8605 |
| Entity | 0.8262 |   0.8116  | 0.8414 |
+--------+--------+-----------+--------+
2024-06-23 23:43:12 - INFO: TEST Label F1 [0.99894697 0.90225691 0.81818182 0.73886463 0.75037821 0.75318656
 0.86086957]
2024-06-23 23:43:12 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8318 |   0.8236  | 0.8427 |
| Entity | 0.7919 |   0.7927  | 0.7911 |
+--------+--------+-----------+--------+
2024-06-23 23:43:13 - INFO: Epoch: 2
2024-06-23 23:49:30 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0063 | 0.8172 |   0.8383  | 0.7985 |
+---------+--------+--------+-----------+--------+
2024-06-23 23:50:07 - INFO: EVAL Label F1 [0.99911708 0.91224571 0.86884003 0.79319149 0.75386779 0.81147541
 0.82178218]
2024-06-23 23:50:07 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8515 |   0.8499  | 0.8536 |
| Entity | 0.8368 |   0.8513  | 0.8227 |
+--------+--------+-----------+--------+
2024-06-23 23:50:45 - INFO: TEST Label F1 [0.99901489 0.90896334 0.82035134 0.7458194  0.76201286 0.75630252
 0.86666667]
2024-06-23 23:50:45 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8370 |   0.8475  | 0.8286 |
| Entity | 0.7982 |   0.8297  | 0.7690 |
+--------+--------+-----------+--------+
2024-06-23 23:50:46 - INFO: Epoch: 3
2024-06-23 23:57:02 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0057 | 0.8331 |   0.8533  | 0.8152 |
+---------+--------+--------+-----------+--------+
2024-06-23 23:57:40 - INFO: EVAL Label F1 [0.99908817 0.91202873 0.85758125 0.77333333 0.76892028 0.79455782
 0.84878049]
2024-06-23 23:57:40 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8506 |   0.8435  | 0.8600 |
| Entity | 0.8321 |   0.8073  | 0.8583 |
+--------+--------+-----------+--------+
2024-06-23 23:58:17 - INFO: TEST Label F1 [0.99901206 0.90649511 0.82344102 0.75559238 0.78168438 0.74816626
 0.85581395]
2024-06-23 23:58:17 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8386 |   0.8456  | 0.8349 |
| Entity | 0.8018 |   0.7957  | 0.8080 |
+--------+--------+-----------+--------+
2024-06-23 23:58:17 - INFO: Epoch: 4
2024-06-24 00:04:33 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0053 | 0.8458 |   0.8604  | 0.8325 |
+---------+--------+--------+-----------+--------+
2024-06-24 00:05:11 - INFO: EVAL Label F1 [0.99915021 0.91403871 0.87464345 0.794193   0.77843137 0.81568627
 0.82296651]
2024-06-24 00:05:11 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8570 |   0.8484  | 0.8663 |
| Entity | 0.8435 |   0.8422  | 0.8447 |
+--------+--------+-----------+--------+
2024-06-24 00:05:48 - INFO: TEST Label F1 [0.9990321  0.9076631  0.83134694 0.75084746 0.77799763 0.76449704
 0.87387387]
2024-06-24 00:05:48 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8436 |   0.8475  | 0.8408 |
| Entity | 0.8063 |   0.8227  | 0.7906 |
+--------+--------+-----------+--------+
2024-06-24 00:05:49 - INFO: Epoch: 5
2024-06-24 00:12:05 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0049 | 0.8562 |   0.8701  | 0.8434 |
+---------+--------+--------+-----------+--------+
2024-06-24 00:12:43 - INFO: EVAL Label F1 [0.99918534 0.91684815 0.87959403 0.79571811 0.78926441 0.80491132
 0.85714286]
2024-06-24 00:12:43 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8632 |   0.8740  | 0.8537 |
| Entity | 0.8486 |   0.8655  | 0.8324 |
+--------+--------+-----------+--------+
2024-06-24 00:13:21 - INFO: TEST Label F1 [0.99905592 0.91049974 0.82818501 0.74125874 0.78096006 0.75828221
 0.90566038]
2024-06-24 00:13:21 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8463 |   0.8707  | 0.8250 |
| Entity | 0.8043 |   0.8386  | 0.7728 |
+--------+--------+-----------+--------+
2024-06-24 00:13:22 - INFO: Epoch: 6
2024-06-24 00:19:38 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0045 | 0.8651 |   0.8778  | 0.8535 |
+---------+--------+--------+-----------+--------+
2024-06-24 00:20:15 - INFO: EVAL Label F1 [0.99917825 0.9157633  0.88403412 0.785404   0.78506462 0.80733945
 0.87254902]
2024-06-24 00:20:15 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8642 |   0.8592  | 0.8699 |
| Entity | 0.8501 |   0.8478  | 0.8524 |
+--------+--------+-----------+--------+
2024-06-24 00:20:53 - INFO: TEST Label F1 [0.99906494 0.90967855 0.83853329 0.75767918 0.78335278 0.77712952
 0.875     ]
2024-06-24 00:20:53 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8486 |   0.8580  | 0.8406 |
| Entity | 0.8125 |   0.8216  | 0.8037 |
+--------+--------+-----------+--------+
2024-06-24 00:20:54 - INFO: Epoch: 7
2024-06-24 00:27:10 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0042 | 0.8725 |   0.8834  | 0.8624 |
+---------+--------+--------+-----------+--------+
2024-06-24 00:27:48 - INFO: EVAL Label F1 [0.9991768  0.91395072 0.88377688 0.79307359 0.78150852 0.80926431
 0.86538462]
2024-06-24 00:27:48 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8637 |   0.8627  | 0.8653 |
| Entity | 0.8499 |   0.8524  | 0.8473 |
+--------+--------+-----------+--------+
2024-06-24 00:28:26 - INFO: TEST Label F1 [0.99906906 0.91074395 0.83729255 0.75364807 0.78116343 0.76662636
 0.86792453]
2024-06-24 00:28:26 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8452 |   0.8605  | 0.8319 |
| Entity | 0.8107 |   0.8284  | 0.7937 |
+--------+--------+-----------+--------+
2024-06-24 00:28:26 - INFO: Epoch: 8
2024-06-24 00:34:43 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0039 | 0.8792 |   0.8893  | 0.8697 |
+---------+--------+--------+-----------+--------+
2024-06-24 00:35:21 - INFO: EVAL Label F1 [0.99918495 0.91346922 0.8871162  0.78441558 0.78304239 0.79944675
 0.86538462]
2024-06-24 00:35:21 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8617 |   0.8661  | 0.8581 |
| Entity | 0.8499 |   0.8557  | 0.8442 |
+--------+--------+-----------+--------+
2024-06-24 00:35:58 - INFO: TEST Label F1 [0.99907992 0.91022488 0.84165989 0.75191816 0.78194277 0.74969174
 0.87850467]
2024-06-24 00:35:58 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8447 |   0.8632  | 0.8287 |
| Entity | 0.8113 |   0.8328  | 0.7908 |
+--------+--------+-----------+--------+
2024-06-24 00:35:58 - INFO: Epoch: 9
2024-06-24 00:42:14 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0038 | 0.8845 |   0.8955  | 0.8743 |
+---------+--------+--------+-----------+--------+
2024-06-24 00:42:52 - INFO: EVAL Label F1 [0.99918899 0.91453077 0.88658555 0.79069767 0.78152929 0.7967033
 0.85990338]
2024-06-24 00:42:52 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8613 |   0.8638  | 0.8594 |
| Entity | 0.8493 |   0.8531  | 0.8455 |
+--------+--------+-----------+--------+
2024-06-24 00:43:30 - INFO: TEST Label F1 [0.99907416 0.91052632 0.84009082 0.75532822 0.77836092 0.76248477
 0.86792453]
2024-06-24 00:43:30 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8448 |   0.8626  | 0.8292 |
| Entity | 0.8109 |   0.8307  | 0.7920 |
+--------+--------+-----------+--------+
2024-06-24 00:43:30 - INFO: Best DEV F1: 0.8501
2024-06-24 00:43:30 - INFO: Best TEST F1: 0.8125
2024-06-24 00:44:08 - INFO: TEST Label F1 [0.99906494 0.90967855 0.83853329 0.75767918 0.78335278 0.77712952
 0.875     ]
2024-06-24 00:44:08 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.8486 |   0.8580  | 0.8406 |
|   Entity   | 0.8125 |   0.8216  | 0.8037 |
+------------+--------+-----------+--------+
